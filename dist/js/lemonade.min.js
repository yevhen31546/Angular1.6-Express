"use strict";function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}window.$,window.angular.module("lemonadeReward",["ui.router","restangular","ngStorage","ngMessages","ui.bootstrap","angulartics","angulartics.google.analytics","nvd3ChartDirectives","angular-loading-bar","rzModule","ngComboDatePicker"]),function(e,t){function a(e,t,a,n,r,o,i,l,c){t.dateYear=new Date}a.$inject=["$rootScope","$scope","$location","$state","$window","$document","BreadcrumbService","BaseDataService","$timeout"],t.module("lemonadeReward").run(["$rootScope","$location","BaseDataService","BreadcrumbService","CloneService","$state","DetectionService",function(t,e,a,n,r,o,i){t.realterms="yes",t.growthRateText="mid",t.DOB="",t.about_age=55,t.about_ret=65,t.sliderMinAge=55,t.about_gender="",t.pension_potList=[],t.pension_potSum=0,t.stateValue=!1,t.state="",t.statePensionAssValue="",t.finalsalary_list=[],t.finalsalary_sum=0,t.salaryBeforeTax="",t.yourSavings=0,t.amount="",t.yourPerc="",t.empSavings=0,t.empAmount="",t.empPerc="",t.timeline={upto:100},t.validAbout=[!1,!1,!1],t.validPension=[!1,!0,!1],t.validPlans=[!1,!0,!0],t.incomeTarget=void 0,t.tableCounter=0,t.fixIncomeLevel="no",t.clonelink="";var l=e.search();a.getApiData().then(function(e){t.serverRun=!0,t.appData=e.data,t.tfcToken=t.appData.max_TFC,t.inflation=parseFloat(t.appData.inflation),t.pension_charge=parseFloat(t.appData.pension_charge),t.menu_about={backgroundColor:"#FFFFFF",color:t.appData.branding.fontColor},t.menu_pension={backgroundColor:t.appData.branding.mainColorDark,color:t.appData.branding.headerFontColor},t.menu_plans={backgroundColor:t.appData.branding.mainColorDark,color:t.appData.branding.headerFontColor},t.menu_options={backgroundColor:t.appData.branding.mainColorDark,color:t.appData.branding.headerFontColor},t.companyScreen=n.companyName(),"yes"==l.clone?(r.storeGet(l),o.transitionTo("lr.clone")):o.transitionTo("lr.home")},function(){t.serverRun=!1,t.appData=a.getBackupData(),t.tfcToken=t.appData.max_TFC,t.inflation=parseFloat(t.appData.inflation),t.pension_charge=parseFloat(t.appData.pension_charge),t.menu_about={backgroundColor:"#FFFFFF",color:t.appData.branding.fontColor},t.menu_pension={backgroundColor:t.appData.branding.mainColorDark,color:t.appData.branding.headerFontColor},t.menu_plans={backgroundColor:t.appData.branding.mainColorDark,color:t.appData.branding.headerFontColor},t.menu_options={backgroundColor:t.appData.branding.mainColorDark,color:t.appData.branding.headerFontColor},t.companyScreen=n.companyName(),"yes"==l.clone?(r.storeGet(l),o.transitionTo("lr.clone")):o.transitionTo("lr.home")})}]),t.module("lemonadeReward").controller("AppController",a)}(window.$,window.angular),function(e,t){function a(e,t,a,n){e.state("lr",{abstract:!0,views:{main:{},clients:{templateUrl:"views/abstract/clients/index.html"}}}),t.otherwise("/"),n.virtualPageviews(!0),a.html5Mode(!0)}a.$inject=["$stateProvider","$urlRouterProvider","$locationProvider","$analyticsProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(e,t,a,n){this.resp=n.mainCollector(),t.fetchData=function(){return[{key:"Series 1",values:[[1,[4,6]],[2,8],[3,9],[4,12],[1,3]]}]},t.exampleData=t.fetchData(),t.calc=function(){var e=t.exampleData;e[0].values[0][1]=6,t.exampleData=e}}a.$inject=["$rootScope","$scope","ChartDataService","CalculationService"],t.module("lemonadeReward").controller("ChartController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.chart",{url:"/chart",views:{"main@":{templateUrl:"views/chart/index.html"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,a){function t(n,r,e,o,t){""!=r.DOB&&(n.dateOfBirth=r.DOB),n.today=new Date,n.yearsEnd=n.today.getFullYear()-25,n.yearsStart=n.today.getFullYear()-75,n.dateOptions={minDate:new Date(n.yearsStart,1,1),maxDate:new Date(n.yearsEnd,1,1)},n.$watch("dateOfBirth",function(e,t){r.DOB=n.dateOfBirth;var a=o.dob();r.sliderMinAge=a.age,r.sliderMinAge>=r.about_ret&&(r.about_ret=r.sliderMinAge),r.sliderMinAge<55?(r.sliderMinAge=55,r.minAgeMsg=!0):r.minAgeMsg=!1}),n.retAge=r.about_ret,n.$watch("retAge",function(e,t,a){r.about_ret=e}),n.gen=r.about_gender,n.$watch("gen",function(e,t,a){r.about_gender=e}),n.pensionPotValue=r.pension_potSum,n.$watch("pensionPotValue",function(e,t,a){r.pension_potList=new Array,r.pension_potList.push({id:"pot1",value:e}),r.pension_potSum=e}),0<r.finalsalary_list.length?n.choices=r.finalsalary_list:n.choices=[],n.addNewChoice=function(){if(n.choices.length<3){var e=n.choices.length+1;n.choices.push({id:e}),n.finalSum()}},n.removeChoice=function(){var e=n.choices.length-1;n.choices.splice(e),n.finalSum(),n.$broadcast("stepsRevalidate",!0)},n.finalSum=function(){n.sum=0,a.forEach(n.choices,function(e,t){n.potvalue=parseInt(e.value),isNaN(n.potvalue)||(n.sum=n.sum+parseInt(e.value))}),r.finalsalary_sum=n.sum,r.finalsalary_list=n.choices},n.inputDevice=[{value:"yes",label:"Yes"},{value:"no",label:"No"}],n.stateScope=r.state,n.userStatePension=r.statePensionAssValue,n.$watch("stateScope",function(e,t,a){"yes"==e?(r.stateValue=!0,r.state="yes",0<n.userStatePension||(n.userStatePension=parseInt(52*r.appData.state_pension_week),r.statePensionAssValue=n.userStatePension)):(r.stateValue=!1,r.state="no",r.statePensionAssValue="",n.userStatePension="")}),n.$watch("userStatePension",function(e,t,a){0<e?(n.stateScope="yes",r.stateValue=!0,r.state="yes",r.statePensionAssValue=e):(n.stateScope="no",r.state="no",r.stateValue=!1,r.statePensionAssValue="")},!0),n.currentSalary=parseInt(r.salaryBeforeTax),n.$watch("currentSalary",function(e,t,a){r.salaryBeforeTax=e}),n.yourcontrib=parseFloat(r.yourSavings.toFixed(2)),n.$watch("yourcontrib",function(e,t,a){r.yourSavings=e,r.yourSavingValue=e,r.amount="yes",r.yourPerc="",r.yourSavingPer=""}),n.empcontrib=parseFloat(r.empSavings.toFixed(2)),n.$watch("empcontrib",function(e,t,a){r.empSavings=e,r.empSavingValue=e,r.empAmount="yes",r.empPerc="",r.empSavingPer=""}),n.showError=!1,n.validate=function(){n.globalValidArray=new Array,n.validValue={},n.validMsg={},n.ageValid=t.ageValid(),0==n.ageValid.valid?(n.validMsg.age=n.ageValid.error,n.validValue.age=!1,n.globalValidArray.push(!1)):(n.validValue.age=!0,n.validMsg.age=!1),n.retageValid=t.retageValid(),0==n.retageValid.valid?(n.validMsg.ret=n.retageValid.error,n.validValue.ret=!1,n.globalValidArray.push(!1)):(n.validValue.ret=!0,n.validMsg.ret=!1),n.genderValid=t.genderValid(),0==n.genderValid.valid?(n.validMsg.gender=n.genderValid.error,n.validValue.gender=!1,n.globalValidArray.push(!1)):(n.validValue.gender=!0,n.validMsg.gender=!1),n.potValid=t.potValid(),0==n.potValid.valid?(n.validMsg.pot=n.potValid.error,n.validValue.pot=!1,n.globalValidArray.push(!1)):(n.validValue.pot=!0,n.validMsg.pot=!1),n.finalValid=t.finalValid(),0==n.finalValid.valid?(n.validMsg.final=n.finalValid.error,n.validValue.final=!1,n.globalValidArray.push(!1)):(n.validValue.final=!0,n.validMsg.final=!1),n.stateValid=t.stateValid(),0==n.stateValid.valid?(n.validMsg.state=n.stateValid.error,n.validValue.state=!1,n.globalValidArray.push(!1)):(n.validValue.state=!0,n.validMsg.state=!1),n.salaryValid=t.salaryValid(),0==n.salaryValid.valid?(n.validMsg.salary=n.salaryValid.error,n.validValue.salary=!1,n.globalValidArray.push(!1)):(n.validValue.salary=!0,n.validMsg.salary=!1),n.yourSaveValid=t.yourSaveValid(),0==n.yourSaveValid.valid?(n.validMsg.yourcont="Please, provide a valid value.",n.validValue.yourcont=!1,n.globalValidArray.push(!1)):(n.validValue.yourcont=!0,n.validMsg.yourcont=!1),n.empSaveValid=t.empSaveValid(),0==n.empSaveValid.valid?(n.validMsg.empcont="Please, provide a valid value.",n.validValue.empcont=!1,n.globalValidArray.push(!1)):(n.validValue.empcont=!0,n.validMsg.empcont=!1),0==n.globalValidArray.length?(r.validAbout=[!0,!0,!0],r.validPension=[!0,!0,!0],r.validPlans=[!0,!0,!0],n.active={backgroundColor:"#FFFFFF",color:r.appData.branding.fontColor},n.inactive={backgroundColor:r.appData.branding.mainColorDark,color:r.appData.branding.headerFontColor},r.menu_about=n.inactive,r.menu_pension=n.inactive,r.menu_plans=n.inactive,r.menu_options=n.active,e.url("/options/table")):n.showError=!0}}t.$inject=["$scope","$rootScope","$location","CalculationService","BreadcrumbService"],a.module("lemonadeReward").controller("CloneController",t)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.clone",{url:"/clone",views:{"main@":{templateUrl:"views/clone/index.html",controller:"CloneController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),window.$,window.angular.module("lemonadeReward").directive("annuityModal",["$rootScope",function(e){return{restrict:"E",replace:!0,templateUrl:"views/directives/annuityModal/annuityModal.html",controller:["$scope",function(e){}]}}]),window.$,window.angular.module("lemonadeReward").directive("cashoutModal",["$rootScope","CalculationService",function(e,t){return{restrict:"E",replace:!0,templateUrl:"views/directives/cashoutModal/cashoutModal.html",controller:["$scope",function(e){e.calc=t.mainCollector()}]}}]),function(f){window.angular.module("lemonadeReward").directive("barChart",["$rootScope","CalculationService","$filter","$timeout",function(u,d,m,p){return{restrict:"E",template:'<svg id="{{ whichChart }}"  height="470px"  ng-attr-style="height:470px; background-color: white;"></svg>',link:function(o,e,t,a){switch(p(function(){f("svg").on("mouseover",function(){f("#lifeBox0").prependTo(f("svg"))}),e.on("click",".incometargetplusclass",function(){if(u.incomeTarget<o.chartHelperMax){switch(u.incomeTarget=parseInt(u.incomeTarget)+100,o.calc=d.mainCollector(),o.whichChart){case"annuity":var e=o.calc.annuity.chart;break;case"cashout":e=o.calc.cashOut.chart;break;case"flexible":e=o.calc.flexibleChart.chart;break;default:e=null}n(e),r(),o.$emit("sliderUpdate")}}),e.on("click",".incometargetminusclass",function(){if(o.chartHelperMin<u.incomeTarget){switch(u.incomeTarget=parseInt(u.incomeTarget)-100,o.calc=d.mainCollector(),o.whichChart){case"annuity":var e=o.calc.annuity.chart;break;case"cashout":e=o.calc.cashOut.chart;break;case"flexible":e=o.calc.flexibleChart.chart;break;default:e=null}n(e),r(),o.$emit("sliderUpdate")}})}),o.whichChart){case"annuity":o.calc.annuity.chart;break;case"cashout":o.calc.cashOut.chart;break;case"flexible":o.calc.flexibleChart.chart;break;default:}var i;e.find("#"+o.whichChart);o.calc=d.mainCollector(),o.chartHelperMax=o.calc.chartHelper.limitMaxYaxis,o.chartHelperMin=o.calc.chartHelper.limitMinYaxis;function l(){d3.select("#lifeBox0").remove();var e=d3.select("#"+o.whichChart),t=i.margin(),a=e.style("height").split("px")[0],n=e.style("width").split("px")[0],r=(o.calc.annuityLongevity.lifeExpectancy-u.about_ret)/(u.timeline.upto-u.about_ret)*(n-t.left-t.right);e.append("rect").attr("x",t.left).attr("y",t.top).attr("width",r).attr("id","lifeBox0").attr("height",a-t.top-t.bottom).attr("fill","rgba(0,0,0, 0.04)"),d3.select("#lifeBox").remove(),e.append("rect").attr("x",r+t.left).attr("y",t.top+20).attr("width",140).attr("height",40).attr("id","lifeBox").attr("fill","rgba(0,0,0, 0.04)").classed("label-lifeExp",!0),d3.select("#lifeBox2").remove(),e.append("rect").attr("x",t.left).attr("y",t.top-2).attr("width",n).attr("height",2).attr("id","lifeBox2").attr("fill","rgba(0,0,0, 0.08)"),d3.select("#graphlinebottom").remove(),e.append("rect").attr("x",t.left).attr("y",a-t.bottom).attr("width",n).attr("height",2).attr("id","graphlinebottom").attr("fill","rgba(0,0,0, 0.08)"),d3.select("#lifeBoxText").remove(),e.append("text").attr("x",r+t.left).attr("y",t.top+20+22).attr("width",80).attr("height",40).attr("fill","rgba(0,0,0,0.3)").attr("dy",".2em").attr("id","lifeBoxText").text("Life Expectancy"),d3.select("#lifeBoxTextValue").remove(),e.append("text").attr("x",r+t.left+106).attr("y",t.top+20+22).attr("width",40).attr("height",40).attr("fill","rgba(0,0,0,0.6)").attr("dy",".2em").style("font-weight","bold").style("font-size","16px").attr("id","lifeBoxTextValue").text(o.calc.annuityLongevity.lifeExpectancy)}var n=function(e){d3.select("#"+o.whichChart).datum(e).transition(d3.easeLinear).call(i)},r=function(){var e=c.width,t=c.height-c.margin.top-c.margin.bottom,a=c.height-c.margin.bottom-t/c.maxYvalue*o.incomeTarget;d3.selectAll("#"+o.whichChart+" line").remove(),d3.select("#"+o.whichChart).append("line").style("stroke","#77b800").style("stroke-width","1px").style("stroke-dasharray","6").attr("class","lifeExpectLine").attr("x1",c.margin.left).attr("y1",a).attr("x2",e).attr("y2",a),d3.select("#incometargetplus").remove(),d3.select("#"+o.whichChart).append("rect").attr("x",c.width-40).attr("y",a-10).attr("width",20).attr("height",20).attr("id","incometargetplus").attr("class","incometargetplusclass").attr("fill","#daf4a8"),d3.select("#incometargetplustext").remove(),d3.select("#"+o.whichChart).append("text").attr("x",c.width-33).attr("y",a-6).attr("width",20).attr("height",20).attr("fill","#77b800").attr("dy",".9em").attr("id","incometargetplustext").attr("class","incometargetplusclass").text("+"),d3.select("#incometargetminus").remove(),d3.select("#"+o.whichChart).append("rect").attr("x",c.width-130).attr("y",a-10).attr("width",20).attr("height",20).attr("id","incometargetminus").attr("class","incometargetminusclass").attr("fill","#daf4a8"),d3.select("#incometargetminustext").remove(),d3.select("#"+o.whichChart).append("text").attr("x",c.width-122).attr("y",a-7).attr("width",20).attr("height",20).attr("fill","#77b800").attr("dy",".9em").attr("id","incometargetminustext").attr("class","incometargetminusclass").text("-"),d3.select("#incometargetbg").remove(),d3.select("#"+o.whichChart).append("rect").attr("x",c.width-110).attr("y",a-10).attr("width",70).attr("height",20).attr("id","incometargetbg").style("stroke","#daf4a8").style("stroke-width","1").attr("fill","#ffffff"),d3.select("#incometargettext").remove(),d3.select("#"+o.whichChart).append("text").attr("x",c.width-100).attr("y",a-3).attr("width",50).attr("height",20).attr("fill","#77b800").attr("dy",".6em").attr("id","incometargettext").text(m("currency")(o.calc.flexible.eachYearBeforeTax,"£",0))};o.$on("chartloaded",function(){switch(o.calc=d.mainCollector(),o.whichChart){case"annuity":var e=o.calc.annuity.chart;break;case"cashout":e=o.calc.cashOut.chart;break;case"flexible":e=o.calc.flexibleChart.chart;break;default:e=null}l(),n(e),r()}),nv.addGraph(function(){i=nv.models.multiBarChart().transitionDuration(50).reduceXTicks(!0).rotateLabels(0).groupSpacing(.7).showLegend(!0).color(["#ef7e0a","#acacac","#585858","#202020","#000000"]).stacked(!0).showControls(!1),l(),i.tooltipContent(function(e,t,a){return'<span style="padding:3px;">'+e+": <b>"+a+"</b></span>"}),i.color(function(e){return e.data.color});var e=d3.select("#"+o.whichChart),t=i.margin(),a=e.style("height").split("px")[0],n=e.style("width").split("px")[0],r=o.calc.chartHelper.maxYaxis;i.forceY([0,r]),s(n,a,t,r);i.yAxis.tickFormat(function(e){return"£"+d3.format(",f")(e)}),i.noData("");o.calc.annuityLongevity.lifeExpectancy,u.about_ret,u.timeline.upto,u.about_ret,t.left,t.right;if(0<u.tfcToken){e.append("rect").attr("x",t.left).attr("y",t.top+20).attr("width",2).attr("height",a-t.bottom-t.top-20).attr("fill","rgba(0,0,0,0.8)");if(e.append("rect").attr("x",t.left).attr("y",t.top+20).attr("width",140).attr("height",40).attr("fill","rgba(0,0,0, 0.8)"),e.append("text").attr("x",t.left+10).attr("y",t.top+20+18).attr("width",40).attr("height",40).attr("fill","rgba(255,255,255,1)").style("font-size","10px").text("Lump"),e.append("text").attr("x",t.left+10).attr("y",t.top+20+30).attr("width",40).attr("height",40).attr("fill","rgba(255,255,255,1)").style("font-size","10px").text("Sum"),e.append("text").attr("x",t.left+50).attr("y",t.top+20+26).attr("width",40).attr("height",40).attr("fill","rgba(255,255,255,1)").style("font-size","14px").style("font-weight","bold").text(m("currency")(o.calc.pensionFundAtRetirement.tcfValue,"£",0)),e.append("rect").attr("x",t.left+140).attr("y",t.top+20).attr("width",50).attr("height",40).attr("fill","rgba(119,184,0, 1)"),e.append("text").attr("x",t.left+140+10).attr("y",t.top+20+18).attr("width",40).attr("height",40).attr("fill","rgba(255,255,255,1)").style("font-size","9px").text("TAX"),e.append("text").attr("x",t.left+140+10).attr("y",t.top+20+30).attr("width",40).attr("height",40).attr("fill","rgba(255,255,255,1)").style("font-size","9px").text("FREE"),"cashout"==o.whichChart){e.append("rect").attr("x",t.left).attr("y",t.top+20+50).attr("width",140).attr("height",40).attr("fill","rgba(0,0,0, 0.8)"),e.append("text").attr("x",t.left+10).attr("y",t.top+20+50+18).attr("width",40).attr("height",40).attr("fill","rgba(255,255,255,1)").style("font-size","10px").text("Lump"),e.append("text").attr("x",t.left+10).attr("y",t.top+20+50+30).attr("width",40).attr("height",40).attr("fill","rgba(255,255,255,1)").style("font-size","10px").text("Sum"),e.append("text").attr("x",t.left+50).attr("y",t.top+20+50+26).attr("width",40).attr("height",40).attr("fill","rgba(255,255,255,1)").style("font-size","14px").style("font-weight","bold").text(m("currency")(o.calc.pensionFundAtRetirement.remainingFutureFound,"£",0)),e.append("rect").attr("x",t.left+140).attr("y",t.top+20+50).attr("width",50).attr("height",40).attr("fill","rgba(182,31,71, 1)"),e.append("text").attr("x",t.left+140+8).attr("y",t.top+20+50+23).attr("width",40).attr("height",40).attr("fill","rgba(255,255,255,1)").style("font-size","9px").text("TAXED")}}return nv.utils.windowResize(function(){i.update()}),o.$emit("chartloaded"),i});var c={},s=function(e,t,a,n){c={width:e,height:t,margin:a,maxYvalue:n}}}}}])}(window.$),window.$,window.angular.module("lemonadeReward").directive("contactUs",["$rootScope",function(e){return{restrict:"E",replace:!0,templateUrl:"views/directives/contactUs/contactUs.html",controller:["$scope","$rootScope","$location","ContactService",function(a,n,e,r){a.showForm=!0,a.privacyChecked=!1,a.pensionDataChecked=!1,a.submitForm=function(e){var t={firstname:a.user.fname,lastname:a.user.lname,email:a.user.email,phone:a.user.phone,"message:":a.user.message,subject:"R.O.P - "+n.appData.branding.companyName+" - Contact US"};a.pensionDataChecked&&(t.Duplicate_Link=n.clonelink),e&&r.mail(t).then(function(e){0==e.data.error?(a.showForm=!1,a.sending=!0):(a.showForm=!1,a.sending=!1)},function(e){a.sending=!1,a.showForm=!1})}}]}}]),function(r){window.angular.module("lemonadeReward").directive("dob",["$rootScope",function(e){return{restrict:"E",replace:!0,templateUrl:"views/directives/dob/dob.html",controller:["$scope",function(e){}],link:function(e,t,a,n){r("#dobDirective [ng-model=year]").focus(function(){!0!==r(this).data("focused")&&(r(this).data("focused",!0),r("#dobDirective [ng-model=year]").children(":nth-child(25)").after('<option label="Year" value="string:">Year</option>'),r("#dobDirective [ng-model=year]").children(":nth-child(26)").prop("selected",!0))}),r("#mySelect").blur(function(){r(this).data("focused",!1)})}}}])}(window.$),window.$,window.angular.module("lemonadeReward").directive("flexibleModal",["$rootScope",function(e){return{restrict:"E",replace:!0,templateUrl:"views/directives/flexibleModal/flexibleModal.html",controller:["$scope",function(e){}]}}]),window.$,window.angular.module("lemonadeReward").directive("mainFooter",["$rootScope","BreadcrumbService","$location",function(e,a,t){return{restrict:"E",replace:!0,templateUrl:"views/directives/footer/footer.html",controller:["$scope","$timeout",function(t,e){t.$on("$locationChangeStart",function(e){t.footerOnOff=a.footerShow()})}]}}]),window.$,window.angular.module("lemonadeReward").directive("mainHeader",["$rootScope","$location","BreadcrumbService",function(e,t,a){return{restrict:"E",replace:!0,templateUrl:"views/directives/header/header.html",controller:["$scope","$timeout",function(t,e){t.$on("$locationChangeStart",function(e){t.hideHeader=a.getHeader(),t.company=a.companyName()})}]}}]),function(e,r){r.module("lemonadeReward").directive("mainMenu",["$rootScope","$location","$state",function(n,e,t){return{restrict:"E",replace:!0,templateUrl:"views/directives/menu/menu.html",controller:["$rootScope","$scope","$location","$state",function(e,t,a,n){t.active={backgroundColor:"#FFFFFF",color:e.appData.branding.fontColor},t.inactive={backgroundColor:e.appData.branding.mainColorDark,color:e.appData.branding.headerFontColor},e.$on("$locationChangeSuccess",function(){switch(e.mainStep=a.path().split("/")[1],e.mainStep){case"":e.menu_about=t.inactive,e.menu_pension=t.inactive,e.menu_plans=t.inactive,e.menu_options=t.inactive;break;case"about":e.menu_about=t.active,e.menu_pension=t.inactive,e.menu_plans=t.inactive,e.menu_options=t.inactive;break;case"pension":e.menu_about=t.inactive,e.menu_pension=t.active,e.menu_plans=t.inactive,e.menu_options=t.inactive;break;case"plans":e.menu_about=t.inactive,e.menu_pension=t.inactive,e.menu_plans=t.active,e.menu_options=t.inactive;break;case"options":e.menu_about=t.inactive,e.menu_pension=t.inactive,e.menu_plans=t.inactive,e.menu_options=t.active;break;default:e.menu_about=t.inactive,e.menu_pension=t.inactive,e.menu_plans=t.inactive,e.menu_options=t.inactive}}),t.allTrue=function(e){for(var t in e)if(0==e[t])return!1;return!0}}],link:function(t,e,a){t.validUpToPension=function(){e.on("click",function(e){r.element(e.target).hasClass("linkPension")&&(t.allTrue(n.validAbout)||e.preventDefault())})},t.validUpToPlans=function(){e.on("click",function(e){r.element(e.target).hasClass("linkPlans")&&(t.allTrue(n.validAbout)&&t.allTrue(n.validPension)||e.preventDefault())})},t.validUpToOptions=function(){e.on("click",function(e){r.element(e.target).hasClass("linkOptions")&&(t.allTrue(n.validAbout)&&t.allTrue(n.validPension)&&t.allTrue(n.validPlans)||e.preventDefault())})}}}}])}(window.$,window.angular),window.$,window.angular.module("lemonadeReward").directive("optionsForm",function(){return e.$inject=["$rootScope","$scope"],{restrict:"E",templateUrl:"views/directives/options/index.html",controller:e};function e(e,t){}}),window.$,window.angular.module("lemonadeReward").directive("pensionForm",function(){return e.$inject=["$rootScope","$scope","PersonalDataService","$timeout"],{restrict:"E",templateUrl:"views/directives/pension/index.html",controller:e};function e(e,t,a,n){}}),window.$,window.angular.module("lemonadeReward").directive("plansForm",function(){return e.$inject=["$rootScope","$scope"],{restrict:"E",templateUrl:"views/directives/plans/index.html",controller:e};function e(e,t){}}),window.$,window.angular.module("lemonadeReward").directive("printChart",["$rootScope","CalculationService","$filter","$timeout",function(s,n,u,e){return{restrict:"E",template:'<svg id="{{ whichChart }}"  ng-attr-style="height:800px; width:1600px;" xmlns="http://www.w3.org/2000/svg" version="1.1" width="1600" height="800"  viewBox="0 0 1600 800" preserveAspectRatio="xMinYMin meet"></svg>',link:function(o,e,t,a){switch(o.whichChart){case"annuity":o.calc.annuity.chart;break;case"cashout":o.calc.cashOut.chart;break;case"flexible":o.calc.flexibleChart.chart}var i;function l(){d3.select("#lifeBox0"+o.whichChart).remove();var e=d3.select("#"+o.whichChart),t=i.margin(),a=e.style("height").split("px")[0],n=e.style("width").split("px")[0],r=(o.calc.annuityLongevity.lifeExpectancy-s.about_ret)/(s.timeline.upto-s.about_ret)*(n-t.left-t.right);e.append("rect").attr("x",t.left).attr("y",t.top).attr("width",r).attr("id","lifeBox0"+o.whichChart).attr("height",a-t.top-t.bottom).attr("fill","rgba(0,0,0, 0.09)"),d3.select("#lifeBox"+o.whichChart).remove(),e.append("rect").attr("x",r+t.left).attr("y",t.top+20).attr("width",220).attr("height",80).attr("id","lifeBox"+o.whichChart).attr("fill","rgba(0,0,0, 0.08)").classed("label-lifeExp",!0),d3.select("#lifeBox2"+o.whichChart).remove(),e.append("rect").attr("x",t.left).attr("y",t.top-2).attr("width",n).attr("height",2).attr("id","lifeBox2"+o.whichChart).attr("fill","rgba(0,0,0, 0.08)"),d3.select("#graphlinebottom"+o.whichChart).remove(),e.append("rect").attr("x",t.left).attr("y",a-t.bottom).attr("width",n).attr("height",2).attr("id","graphlinebottom"+o.whichChart).attr("fill","rgba(0,0,0, 0.08)"),d3.select("#lifeBoxText"+o.whichChart).remove(),e.append("text").attr("x",r+t.left).attr("y",t.top+20+44).attr("width",160).attr("height",80).attr("fill","rgba(0,0,0,0.6)").attr("dy",".2em").style("font-size","18px").style("font-weight","bold").attr("id","lifeBoxText"+o.whichChart).text("Life Expectancy"),d3.select("#lifeBoxTextValue"+o.whichChart).remove(),e.append("text").attr("x",r+t.left+160).attr("y",t.top+20+44+2).attr("width",40).attr("height",40).attr("fill","rgba(0,0,0,0.6)").attr("dy",".2em").style("font-weight","bold").style("font-size","2em").attr("id","lifeBoxTextValue"+o.whichChart).text(o.calc.annuityLongevity.lifeExpectancy)}e.find("#"+o.whichChart),o.calc=n.mainCollector(),o.chartHelperMax=o.calc.chartHelper.limitMaxYaxis,o.chartHelperMin=o.calc.chartHelper.limitMinYaxis,o.$on("chartloaded",function(){switch(o.calc=n.mainCollector(),o.whichChart){case"annuity":var e=o.calc.annuity.chart;break;case"cashout":e=o.calc.cashOut.chart;break;case"flexible":e=o.calc.flexibleChart.chart;break;default:e=null}l(),function(e){d3.select("#"+o.whichChart).datum(e).transition(d3.easeLinear).call(i)}(e),function(){var e=r.width,t=r.height-r.margin.top-r.margin.bottom,a=r.height-r.margin.bottom-t/r.maxYvalue*o.incomeTarget;d3.select("#"+o.whichChart).append("line").style("stroke","#77b800").style("stroke-width","4px").style("stroke-dasharray","4").attr("class","lifeExpectLine").attr("id","lifeExpectLine"+o.whichChart).attr("x1",r.margin.left).attr("y1",a).attr("x2",e).attr("y2",a),d3.select("#"+o.whichChart).append("rect").attr("x",r.width-200).attr("y",a-25).attr("width",150).attr("height",50).attr("id","incometargetbg"+o.whichChart).attr("fill","#77b800"),d3.select("#"+o.whichChart).append("text").attr("x",r.width-183).attr("y",a-6).attr("width",50).attr("height",20).attr("fill","#ffffff").attr("dy",".6em").style("font-size","25px").attr("id","incometargettext"+o.whichChart).text(u("currency")(o.calc.flexible.eachYearBeforeTax,"£",0))}(),d3.select("#"+o.whichChart).selectAll(".tick text").style("font-size","14px"),d3.select("#"+o.whichChart).selectAll(".tick text").style("font-weight","normal"),d3.select("#"+o.whichChart).selectAll(".tick text").style("color","#c4c4c4"),d3.select("#"+o.whichChart).selectAll(".tick").style("opacity","1"),d3.select("#"+o.whichChart).selectAll(".nv-axisMaxMin text").style("color","#ffffff"),d3.select("#"+o.whichChart).selectAll(".nv-axisMaxMin text").style("display","none"),d3.select("#"+o.whichChart).selectAll(".nv-legend text").style("font-size","13px"),d3.select("#"+o.whichChart).selectAll(".tick line").style("display","none")}),nv.addGraph(function(){i=nv.models.multiBarChart().transitionDuration(50).reduceXTicks(!1).rotateLabels(0).groupSpacing(.7).showLegend(!0).color(["#ef7e0a","#acacac","#585858","#202020","#000000"]).stacked(!0).showControls(!1),l(),i.color(function(e){return e.data.color});var e=d3.select("#"+o.whichChart),t=i.margin(),a=e.style("height").split("px")[0],n=e.style("width").split("px")[0],r=o.calc.chartHelper.maxYaxis;return i.forceY([0,r]),c(n,a,t,r),i.yAxis.tickFormat(function(e){return"£"+d3.format(",f")(e)}),i.noData(""),o.calc.annuityLongevity.lifeExpectancy,s.about_ret,s.timeline.upto,s.about_ret,t.left,t.right,0<s.tfcToken&&(e.append("rect").attr("x",t.left).attr("y",t.top+20).attr("width",2).attr("height",a-t.bottom-t.top-20).attr("fill","rgba(0,0,0,0.8)"),e.append("rect").attr("x",t.left).attr("y",t.top+20).attr("width",250).attr("height",70).attr("fill","rgba(0,0,0, 0.8)"),e.append("text").attr("x",t.left+10).attr("y",t.top+20+30).attr("width",40).attr("height",40).attr("fill","rgba(255,255,255,1)").style("font-size","25px").text("Lump"),e.append("text").attr("x",t.left+10).attr("y",t.top+20+50).attr("width",80).attr("height",80).attr("fill","rgba(255,255,255,1)").style("font-size","20px").text("Sum"),e.append("text").attr("x",t.left+80).attr("y",t.top+20+45).attr("width",80).attr("height",80).attr("fill","rgba(255,255,255,1)").style("font-size","30px").style("font-weight","bold").text(u("currency")(o.calc.pensionFundAtRetirement.tcfValue,"£",0)),e.append("rect").attr("x",t.left+250).attr("y",t.top+20).attr("width",90).attr("height",70).attr("fill","rgba(119,184,0, 1)"),e.append("text").attr("x",t.left+250+20).attr("y",t.top+20+30).attr("width",90).attr("height",80).attr("fill","rgba(255,255,255,1)").style("font-size","18px").text("TAX"),e.append("text").attr("x",t.left+250+20).attr("y",t.top+20+50).attr("width",80).attr("height",80).attr("fill","rgba(255,255,255,1)").style("font-size","19px").text("FREE"),"cashout"==o.whichChart&&(e.append("rect").attr("x",t.left).attr("y",t.top+20+70+30).attr("width",250).attr("height",70).attr("fill","rgba(0,0,0, 0.8)"),e.append("text").attr("x",t.left+10).attr("y",t.top+20+70+60).attr("width",80).attr("height",70).attr("fill","rgba(255,255,255,1)").style("font-size","25px").text("Lump"),e.append("text").attr("x",t.left+10).attr("y",t.top+20+70+80).attr("width",80).attr("height",70).attr("fill","rgba(255,255,255,1)").style("font-size","20px").text("Sum"),e.append("text").attr("x",t.left+80).attr("y",t.top+20+70+70).attr("width",80).attr("height",80).attr("fill","rgba(255,255,255,1)").style("font-size","25px").style("font-weight","bold").text(u("currency")(o.calc.pensionFundAtRetirement.remainingFutureFound,"£",0)),e.append("rect").attr("x",t.left+250).attr("y",t.top+20+70+30).attr("width",90).attr("height",70).attr("fill","rgba(182,31,71, 1)"),e.append("text").attr("x",t.left+250+8).attr("y",t.top+20+70+75).attr("width",80).attr("height",70).attr("fill","rgba(255,255,255,1)").style("font-size","20px").text("TAXED"))),nv.utils.windowResize(function(){i.update()}),o.$emit("chartloaded"),i});var r={},c=function(e,t,a,n){r={width:e,height:t,margin:a,maxYvalue:n}}}}}]),window.$,window.angular.module("lemonadeReward").directive("proceedAnnuityModal",["$rootScope",function(e){return{restrict:"E",replace:!0,templateUrl:"views/directives/proceedAnnuityModal/proceedAnnuityModal.html",controller:["$scope",function(e){}]}}]),window.$,window.angular.module("lemonadeReward").directive("proceedCashoutModal",["$rootScope",function(e){return{restrict:"E",replace:!0,templateUrl:"views/directives/proceedCashoutModal/proceedCashoutModal.html",controller:["$scope",function(e){}]}}]),window.$,window.angular.module("lemonadeReward").directive("proceedFlexibleModal",["$rootScope",function(e){return{restrict:"E",replace:!0,templateUrl:"views/directives/proceedFlexibleModal/proceedFlexibleModal.html",controller:["$scope",function(e){}]}}]),window.$,window.angular.module("lemonadeReward").directive("reviewSummary",["$rootScope","$location","BreadcrumbService",function(e,t,a){return{restrict:"E",replace:!0,templateUrl:"views/directives/reviewSummary/reviewSummary.html",controller:["$scope",function(e){}]}}]),window.$,window.angular.module("lemonadeReward").directive("speakToExpert",["$rootScope",function(e){return{restrict:"E",replace:!0,templateUrl:"views/directives/speakToExpert/speakToExpert.html",controller:["$scope","$rootScope","$location",function(e,t,a){}],link:function(e,t,a,n){}}}]),window.$,window.angular.module("lemonadeReward").directive("startBeforeBtn",["$rootScope","$location","BreadcrumbService",function(e,t,a){return{restrict:"E",replace:!0,templateUrl:"views/directives/startBeforeBtn/startBeforeBtn.html",controller:["$scope","$timeout",function(e,t){}]}}]),function(e,r){r.module("lemonadeReward").directive("steps",["$rootScope","BreadcrumbService",function(e,n){return{restrict:"E",replace:!0,templateUrl:"views/directives/steps/steps.html",controller:["$rootScope","$scope","$timeout",function(e,t,a){t.errorMsg="",e.step=n.getStep(),e.valid={},e.valid.valid=!0,e.valid.error=""}],link:function(a,e,t){a.validate=function(){a.valid=n.validate(),e.on("click",function(e){r.element(e.target).hasClass("nextBtn")&&0==a.valid.valid&&e.preventDefault()})},a.$on("stepsRevalidate",function(e,t){a.validate()})}}}])}(window.$,window.angular),window.$,window.angular.module("lemonadeReward").directive("stillNotSure",["$rootScope",function(e){return{restrict:"E",replace:!0,templateUrl:"views/directives/stillNotSure/stillNotSure.html",controller:["$scope","$rootScope","$location",function(e,t,a){}]}}]),window.$,window.angular.module("lemonadeReward").factory("d3",[function(){return d3}]),window.$,window.angular.module("lemonadeReward").factory("nv",[function(){return nv}]),function(e,t){function a(e,t){var a=e;this.$onInit=function(){a.title="Lemonadereward.com",a.metaDescription="",a.keywords=""}}a.$inject=["$rootScope","BreadcrumbService"],t.module("lemonadeReward").controller("HomeController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.home",{url:"/",views:{"main@":{templateUrl:"views/home/index.html",controller:"HomeController",controllerAs:"vm"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(o,e){function t(a,n,e,t){var r=this;r.open=function(e,t){o(".modal-content > .ng-scope").each(function(){try{o(this).scope().$dismiss()}catch(e){}}),a.open({animation:!0,templateUrl:"views/modals/"+e+".html",controller:"ModalInstanceController",controllerAs:"ModalInstCtrl",size:t})};n.$on("openModal",function(e,t){0==n.tableCounter&&(r.open(t[0],t[1]),n.tableCounter+=1,console.log(n.tableCounter))})}function a(e,t,a){this.ok=function(){e.close()},this.cancel=function(){e.dismiss("cancel")}}t.$inject=["$uibModal","$rootScope","$timeout","$scope"],a.$inject=["$uibModalInstance","$rootScope","$scope"],e.module("lemonadeReward").controller("ModalController",t),e.module("lemonadeReward").controller("ModalInstanceController",a)}(window.$,window.angular),function(e,t){function a(a,n,e,t){switch(t.search().source){case"annuity":n.backLink="annuity";break;case"flexible":n.backLink="flexible";break;case"cashout":n.backLink="cashout";break;default:n.backLink="table"}n.$watch("realterms",function(e,t){a.realterms=e,n.$emit("chartloaded")}),n.$watch("growthRateText",function(e,t){a.growthRateText=e,n.$emit("chartloaded")}),n.$watch("tfcToken",function(e,t){a.tfcToken=e,n.$emit("chartloaded")}),n.$watch("inflation",function(e,t){a.inflation=null==e?a.inflation:e,n.$emit("chartloaded")}),n.$watch("pension_charge",function(e,t){a.pension_charge=null==e?a.pension_charge:e,n.$emit("chartloaded")})}a.$inject=["$rootScope","$scope","CalculationService","$location"],t.module("lemonadeReward").controller("AdvancedSettingsController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.settings",{url:"/options/annuity",views:{"main@":{templateUrl:"views/options/annuity/index.html",controller:"ChartAnnuityController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(a,n,e,t,r,o){n.calc=e.mainCollector(),a.incomeSlider={value:a.incomeTarget,options:{floor:0,ceil:n.calc.chartHelper.maxYaxis,step:100,minLimit:n.calc.chartHelper.limitMinYaxis,maxLimit:n.calc.chartHelper.limitMaxYaxis,vertical:!0,onChange:function(e){a.incomeTarget=n.incomeSlider.value,n.$emit("chartloaded")},hidePointerLabels:!0,hideLimitLabels:!0,showSelectionBar:!1,showTicksValues:!1,ticksValuesTooltip:function(e){return""}}},n.$watch("realterms",function(e,t){a.realterms=e,n.$emit("chartloaded")}),n.updateRetAge=function(e){"plus"==e?a.about_ret<a.timeline.upto&&a.about_ret++:a.about_ret>a.sliderMinAge&&a.about_ret--,n.$emit("chartloaded")},n.$on("sliderUpdate",function(e,t){n.incomeSlider.value=a.incomeTarget,n.$broadcast("rzSliderForceRender")}),n.reset=function(){t.path("/"),r.location.reload()}}a.$inject=["$rootScope","$scope","CalculationService","$location","$window","CloneService"],t.module("lemonadeReward").controller("ChartAnnuityController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.annuity",{url:"/options/settings",views:{"main@":{templateUrl:"views/options/advancedSettings/index.html",controller:"AdvancedSettingsController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(a,n,e,t,r,o){n.calc=e.mainCollector(),a.incomeSlider={value:a.incomeTarget,options:{floor:0,ceil:n.calc.chartHelper.maxYaxis,step:100,minLimit:n.calc.chartHelper.limitMinYaxis,maxLimit:n.calc.chartHelper.limitMaxYaxis,vertical:!0,onChange:function(e){a.incomeTarget=n.incomeSlider.value,n.$emit("chartloaded")},hidePointerLabels:!0,hideLimitLabels:!0,showSelectionBar:!1,showTicksValues:!1,ticksValuesTooltip:function(e){return""}}},n.$watch("realterms",function(e,t){a.realterms=e,n.$emit("chartloaded")}),n.updateRetAge=function(e){"plus"==e?a.about_ret<a.timeline.upto&&a.about_ret++:a.about_ret>a.sliderMinAge&&a.about_ret--,n.$emit("chartloaded")},n.$on("sliderUpdate",function(e,t){n.incomeSlider.value=a.incomeTarget,n.$broadcast("rzSliderForceRender")}),n.reset=function(){r.path("/"),o.location.reload()}}a.$inject=["$rootScope","$scope","CalculationService","$timeout","$location","$window"],t.module("lemonadeReward").controller("ChartCashoutController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.cashout",{url:"/options/cashout",views:{"main@":{templateUrl:"views/options/cashout/index.html",controller:"ChartCashoutController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(a,n,e,t,r){n.calc=e.mainCollector(),a.incomeSlider={value:a.incomeTarget,options:{floor:0,ceil:n.calc.chartHelper.maxYaxis,step:100,minLimit:n.calc.chartHelper.limitMinYaxis,maxLimit:n.calc.chartHelper.limitMaxYaxis,vertical:!0,onChange:function(e){a.incomeTarget=n.incomeSlider.value,n.$emit("chartloaded")},hidePointerLabels:!0,hideLimitLabels:!0,showSelectionBar:!1,showTicksValues:!1,ticksValuesTooltip:function(e){return""}}},n.$watch("realterms",function(e,t){a.realterms=e,n.$emit("chartloaded")}),n.$watch("fixIncomeLevel",function(e,t){a.fixIncomeLevel=e,n.$emit("chartloaded")}),n.updateRetAge=function(e){"plus"==e?a.about_ret<a.timeline.upto&&a.about_ret++:a.about_ret>a.sliderMinAge&&a.about_ret--,n.$emit("chartloaded")},n.$on("sliderUpdate",function(e,t){n.incomeSlider.value=a.incomeTarget,n.$broadcast("rzSliderForceRender")}),n.reset=function(){t.path("/"),r.location.reload()}}a.$inject=["$rootScope","$scope","CalculationService","$location","$window"],t.module("lemonadeReward").controller("ChartFlexibleController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.flexible",{url:"/options/flexible",views:{"main@":{templateUrl:"views/options/flexible/index.html",controller:"ChartFlexibleController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.table",{url:"/options/table",views:{"main@":{templateUrl:"views/options/table/index.html",controller:"TableController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(a,n,e,t,r){a.$emit("openModal",["review","lg"]),a.whichChart="cards",n.calc=e.mainCollector(),n.$watch(function(){return a.growthRateText},function(){n.calc=e.mainCollector()},!0),n.$watch(function(){return a.tfcToken},function(){n.calc=e.mainCollector()},!0),n.$watch(function(){return a.realterms},function(){n.calc=e.mainCollector()},!0),n.$watch(function(){return a.about_ret},function(){n.calc=e.mainCollector()},!0),n.updateRetAge=function(e){"plus"==e?a.about_ret<a.timeline.upto&&a.about_ret++:a.about_ret>a.sliderMinAge&&a.about_ret--,n.$emit("chartloaded")},n.$watch("realterms",function(e,t){a.realterms=e,n.$emit("chartloaded")}),n.reset=function(){t.path("/"),r.location.reload()}}a.$inject=["$rootScope","$scope","CalculationService","$location","$window"],t.module("lemonadeReward").controller("TableController",a)}(window.$,window.angular),function(e,t){function a(e,a){0<e.finalsalary_list.length?a.choices=e.finalsalary_list:a.choices=[],a.addNewChoice=function(){if(a.choices.length<3){var e=a.choices.length+1;a.choices.push({id:e}),a.finalSum()}},a.removeChoice=function(){var e=a.choices.length-1;a.choices.splice(e),a.finalSum(),a.$broadcast("stepsRevalidate",!0)},a.finalSum=function(){a.sum=0,t.forEach(a.choices,function(e,t){a.potvalue=parseInt(e.value),isNaN(a.potvalue)||(a.sum=a.sum+parseInt(e.value))}),e.finalsalary_sum=a.sum,e.finalsalary_list=a.choices}}a.$inject=["$rootScope","$scope"],t.module("lemonadeReward").controller("FinalController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.final",{url:"/pension/final",views:{"main@":{templateUrl:"views/pension/final/index.html",controller:"FinalController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(e,a){0<e.pension_potList.length?a.choices=e.pension_potList:a.choices=[{id:"pot1"}],a.addNewChoice=function(){if(a.choices.length<5){var e=a.choices.length+1;a.choices.push({"":"pot"+e}),a.potSum()}},a.removeChoice=function(){var e=a.choices.length-1;a.choices.splice(e),a.potSum(),a.$broadcast("stepsRevalidate",!0)},a.potSum=function(){a.sum=0,t.forEach(a.choices,function(e,t){a.potvalue=parseInt(e.value),isNaN(a.potvalue)||(a.sum=a.sum+e.value)}),e.pension_potSum=Math.round(a.sum),e.pension_potList=a.choices}}a.$inject=["$rootScope","$scope"],t.module("lemonadeReward").controller("PotController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.pot",{url:"/pension/pot",views:{"main@":{templateUrl:"views/pension/pot/index.html",controller:"PotController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.state",{url:"/pension/state",views:{"main@":{templateUrl:"views/pension/state/index.html",controller:"StateController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(n,r){""!=n.statePensionAssValue?r.userStatePension=n.statePensionAssValue:n.statePensionAssValue,n.state_f=function(e){"yes"==e?(n.stateValue=!0,n.state="yes",r.userStatePension=parseInt(52*n.appData.state_pension_week)):(n.stateValue=!1,n.state="no",r.userStatePension=0)},r.$watch("state",function(e,t,a){"yes"==r.state?(n.statePensionAssValue=r.userStatePension,n.stateValue=!0):(n.stateValue=!1,n.statePensionAssValue=0)},!0),r.$watch("userStatePension",function(e,t,a){0<r.userStatePension?(n.statePensionAssValue=r.userStatePension,n.stateValue=!0,n.state="yes"):(n.statePensionAssValue="",r.userStatePension="")},!0)}a.$inject=["$rootScope","$scope"],t.module("lemonadeReward").controller("StateController",a)}(window.$,window.angular),function(e,t){function a(n,r,e,o){""!=n.DOB&&(r.dateOfBirth=n.DOB),r.today=new Date,r.yearsEnd=r.today.getFullYear()-25,r.yearsStart=r.today.getFullYear()-75,r.dateOptions={minDate:new Date(r.yearsStart,1,1),maxDate:new Date(r.yearsEnd,1,1)},n.minAgeMsg=!1,r.$watch("dateOfBirth",function(e,t){n.DOB=r.dateOfBirth;var a=o.dob();n.sliderMinAge=a.age,n.sliderMinAge>n.about_ret&&(n.about_ret=n.sliderMinAge),n.sliderMinAge<55?(n.sliderMinAge=55,n.minAgeMsg=!0):n.minAgeMsg=!1})}a.$inject=["$rootScope","$scope","BreadcrumbService","CalculationService"],t.module("lemonadeReward").controller("AgeController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.age",{url:"/about/age",views:{"main@":{templateUrl:"views/personalinfo/age/index.html",controller:"AgeController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(t){"male"==t.about_gender?(t.url_gender_male="images/male-hover.png",t.url_gender_female="images/female.png"):"female"==t.about_gender?(t.url_gender_male="images/male.png",t.url_gender_female="images/female-hover.png"):(t.url_gender_male="images/male.png",t.url_gender_female="images/female.png"),t.gender_f=function(e){"male"==(t.gender=e)?(t.url_gender_male="images/male-hover.png",t.url_gender_female="images/female.png",t.about_gender="male"):(t.url_gender_male="images/male.png",t.url_gender_female="images/female-hover.png",t.about_gender="female")}}a.$inject=["$rootScope"],t.module("lemonadeReward").controller("GenderController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.gender",{url:"/about/gender",views:{"main@":{templateUrl:"views/personalinfo/gender/index.html",controller:"GenderController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(e,t,a){t.fillform=function(){var e;t.userdata=(_defineProperty(e={DOB:"1960-03-22",gender:"male",pensionpots:8e5,selectedRetAge:67,currentAnnualSalary:1e5,perYouPayRetPlan:4,perEmpPayRetPlan:1,growthRateText:"mid"},"gender","Male"),_defineProperty(e,"realterms","yes"),_defineProperty(e,"targetIncome",69579),_defineProperty(e,"tfcTaken",25),e),t.submitForm()},t.submitForm=function(){PersonalDataService.setData(t.userdata)}}a.$inject=["$rootScope","$scope","BaseDataService"],t.module("lemonadeReward").controller("PersonalController",a)}(window.$,window.angular),function(e,t){function a(t,a,e){1!=t.retChanged&&(a.custom_ret=e.statePensionAge(t.DOB),a.custom_ret.statePensionAge>t.sliderMinAge&&(t.about_ret=a.custom_ret.statePensionAge)),t.retSlider={value:t.about_ret,options:{floor:t.sliderMinAge,ceil:100,minLimit:t.sliderMinAge,maxLimit:100,showTicks:5,onChange:function(e){t.retChanged=!0,t.about_ret=a.retSlider.value}}}}a.$inject=["$rootScope","$scope","CalculationService"],t.module("lemonadeReward").controller("RetirementController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.retirement",{url:"/about/retirement",views:{"main@":{templateUrl:"views/personalinfo/retirement/index.html",controller:"RetirementController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.personalinfo",{url:"/about",views:{"main@":{templateUrl:"views/personalinfo/index.html",controller:"PersonalController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(t,a){0<t.empSavings?(a.montlySaving=t.empSavings,"yes"==t.empAmount?(a.empSavingValue=t.empSavings,a.montlySaving=t.empSavings):"no"==t.empAmount&&(a.empSavingPer=t.empPerc,a.resultempAmount=t.salaryBeforeTax/12*a.empSavingPer/100,a.montlySaving=t.empSavings)):a.montlySaving=0,t.$watch("salaryBeforeTax",function(){"no"==t.empAmount&&a.empSavingsPer()}),a.empSavingsAmount=function(){a.empSavingPer="",t.empAmount="yes",t.empSavingValue=a.empSavingValue,a.result(a.empSavingValue)},a.empSavingsPer=function(){(a.empSavingValue="")!=t.salaryBeforeTax&&0<t.salaryBeforeTax?a.resultempAmount=t.salaryBeforeTax/12*a.empSavingPer/100:a.resultempAmount=0,t.empAmount="no",t.empPerc=a.empSavingPer,t.empSavingPer=a.empSavingPer,a.result(a.resultempAmount)},a.result=function(e){a.montlySaving=e,t.empSavings=a.montlySaving}}a.$inject=["$rootScope","$scope"],t.module("lemonadeReward").controller("EmployersavingsController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.employersavings",{url:"/plans/employersavings",views:{"main@":{templateUrl:"views/plans/employersavings/index.html",controller:"EmployersavingsController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.salary",{url:"/plans/salary",views:{"main@":{templateUrl:"views/plans/salary/index.html",controller:"SalaryController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(e,t){0<=e.salaryBeforeTax&&""!=e.salaryBeforeTax?t.salary=e.salaryBeforeTax:t.salary="",t.getSalary=function(){e.salaryBeforeTax=t.salary}}a.$inject=["$rootScope","$scope"],t.module("lemonadeReward").controller("SalaryController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.yoursavings",{url:"/plans/yoursavings",views:{"main@":{templateUrl:"views/plans/yoursavings/index.html",controller:"YoursavingsController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),function(e,t){function a(t,a,e){0<=t.yourSavings?(a.montlySaving=t.yourSavings,"yes"==t.amount?(a.yourSavingValue=t.yourSavings,a.montlySaving=t.yourSavings):"no"==t.amount&&(a.yourSavingPer=t.yourPerc,a.resultAmount=t.salaryBeforeTax/12*a.yourSavingPer/100,a.montlySaving=t.yourSavings)):a.montlySaving=0,t.$watch("salaryBeforeTax",function(){"no"==t.amount&&a.yourSavingsPer()}),a.yourSavingsAmount=function(){a.yourSavingPer="",t.amount="yes",t.yourSavingValue=a.yourSavingValue,a.result(a.yourSavingValue)},a.yourSavingsPer=function(){(a.yourSavingValue="")!=t.salaryBeforeTax&&0<t.salaryBeforeTax?a.resultAmount=t.salaryBeforeTax/12*a.yourSavingPer/100:a.resultAmount=0,t.amount="no",t.yourPerc=a.yourSavingPer,t.yourSavingPer=a.yourSavingPer,a.result(a.resultAmount)},a.result=function(e){a.montlySaving=e,t.yourSavings=a.montlySaving}}a.$inject=["$rootScope","$scope","$location"],t.module("lemonadeReward").controller("YoursavingsController",a)}(window.$,window.angular),function(e,t){function a(a,n,e,t,r,o,i,l){a.calc=e.mainCollector(),a.chartTypes=["flexible","annuity","cashout"],a.chartNames=["Flexible Drawdown","Annuity","Cash Out"],a.whichChart="",a.generatePDF=!0,a.sendmail=!1,a.finished=!1,a.showdots=!0,a.resp="Sending",n.identifier=i.generate(),a.pictures={flexible:"",annuity:"",cashout:""},r(function(){svgAsPngUri(document.getElementById("flexible"),{canvg:window.canvg,backgroundColor:"#ffffff",encoderOptions:1},function(e){a.pictures.flexible=e}),svgAsPngUri(document.getElementById("annuity"),{canvg:window.canvg,backgroundColor:"#ffffff",encoderOptions:1},function(e){a.pictures.annuity=e}),svgAsPngUri(document.getElementById("cashout"),{canvg:window.canvg,backgroundColor:"#ffffff",encoderOptions:1},function(e){a.pictures.cashout=e}),a.generatePDF=!1,a.sendmail=!0},5e3),a.submitForm=function(e){if(a.sendmail=!1,a.finished=!0,a.showdots=!0,e.$valid){t={version:n.appData.branding.companyName,about_age:n.about_age,about_ret:n.about_ret,about_gender:n.about_gender,pension_potSum:n.pension_potSum,finalsalary_sum:n.finalsalary_sum,statePensionAssValue:n.statePensionAssValue,salaryBeforeTax:n.salaryBeforeTax,yourSavings:n.yourSavings,empSavings:n.empSavings,printID:a.identifier,inflation:n.inflation,pension_charge:n.pension_charge,tfcToken:n.tfcToken,growthRate:n.growthRateText,growthRateValue:n.appData.investment_return_arr[n.growthRateText],flexible_lumpsum:a.calc.pensionFundAtRetirement.tcfValue,flexible_eachyear:a.calc.flexible.requiredIncome,flexible_lastuntil:a.calc.flexibleChart.runOut.x,flexible_totalpayment:a.calc.flexible.totalpayment,annuity_lumpsum:a.calc.pensionFundAtRetirement.tcfValue,annuity_eachyear:a.calc.annuity.eachYearBeforeTax,annuity_lastuntil:"Income for life",annuity_totalpayment:a.calc.annuity.totalpayment,cashout_lumpsum:a.calc.pensionFundAtRetirement.tcfValue,cashout_eachyear:a.calc.cashOut.taxLumpSum,cashout_lastuntil:"No Income",cashout_totalpayment:a.calc.pensionFundAtRetirement.fullFuturePension,totalpensionpot_atretirement:a.calc.pensionFundAtRetirement.fullFuturePension,incometarget:n.incomeTarget,lifeExpectancy:a.calc.annuityLongevity.lifeExpectancy,realterms:n.realterms,fixIncomeLevel:n.fixIncomeLevel,pic_flexible:a.pictures.flexible,pic_annuity:a.pictures.annuity,pic_cashout:a.pictures.cashout,email:a.useremail,identifier:a.identifier,linkpayload:n.clonelink,template:n.appData.mail_templates.printoption,contact_email:n.appData.contact_email,contact_phone:n.appData.contact_phone},o.mail(t).then(function(e){a.sendmail=!1,a.finished=!0,a.showdots=!1,a.resp=e.data.msg},function(e){a.sendmail=!1,a.finished=!0,a.showdots=!1,a.resp="Sorry, we have some issues, please try again later."})}else a.formValid=!1;var t},a.endOfPrint=function(){l.path("/options/table")}}a.$inject=["$scope","$rootScope","CalculationService","$q","$timeout","PrintService","GenerateID","$location"],t.module("lemonadeReward").controller("PrintController",a)}(window.$,window.angular),function(e,t){function a(e){e.state("lr.print",{url:"/print",views:{"main@":{templateUrl:"views/print/index.html",controller:"PrintController"}}})}a.$inject=["$stateProvider"],t.module("lemonadeReward").config(a)}(window.$,window.angular),window.$,window.angular.module("lemonadeReward").service("BaseBackupService",function(){this.getBackupData=function(){var e={low:1.65,mid:4.65,high:6.05},t={low:e.low-.75-2.5,mid:e.mid-.75-2.5,high:e.high-.75-2.5},a=new Date;return{today:a.getFullYear()+"-"+("0"+(a.getMonth()+1)).slice(-2)+"-"+("0"+a.getDate()).slice(-2),life_expectancy:{55:{men:85,women:88,level:4043,inflation:2319},56:{men:85,women:88,level:4122,inflation:2394},57:{men:85,women:88,level:4205,inflation:2472},58:{men:85,women:88,level:4295,inflation:2554},59:{men:85,women:88,level:4428,inflation:2640},60:{men:85,women:88,level:4547,inflation:2730},61:{men:85,women:88,level:4664,inflation:2852},62:{men:85,women:89,level:4789,inflation:2966},63:{men:86,women:89,level:4928,inflation:3119},64:{men:86,women:88,level:5076,inflation:3280},65:{men:86,women:88,level:5211,inflation:3451},66:{men:86,women:88,level:5354,inflation:3606},67:{men:86,women:88,level:5506,inflation:3752},68:{men:86,women:88,level:5668,inflation:3855},69:{men:86,women:88,level:5840,inflation:4078},70:{men:86,women:88,level:6023,inflation:4290},71:{men:87,women:88,level:6220,inflation:4503},72:{men:87,women:89,level:6431,inflation:4723},73:{men:87,women:89,level:6657,inflation:4943},74:{men:87,women:89,level:6900,inflation:5164},75:{men:88,women:89,level:7161,inflation:5409},76:{men:88,women:89,level:7449,inflation:5731},77:{men:88,women:90,level:7813,inflation:5731},78:{men:88,women:90,level:8207,inflation:6461},79:{men:89,women:90,level:8635,inflation:6873},80:{men:89,women:90,level:9099,inflation:7321},81:{men:89,women:91,level:9603,inflation:7808},82:{men:90,women:91,level:10152,inflation:8340},83:{men:90,women:91,level:10756,inflation:8925},84:{men:91,women:92,level:11417,inflation:9568},85:{men:91,women:92,level:12280,inflation:10269},86:{men:92,women:93,level:13383,inflation:11150},87:{men:92,women:93,level:14662,inflation:12347},88:{men:93,women:94,level:16109,inflation:13701},89:{men:94,women:94,level:17693,inflation:15186},90:{men:94,women:95,level:19301,inflation:16695},91:{men:95,women:95,level:21222,inflation:18470},92:{men:96,women:96,level:23018,inflation:20169},93:{men:96,women:97,level:24944,inflation:21999},94:{men:97,women:97,level:27022,inflation:23982},95:{men:98,women:98,level:29288,inflation:26147},96:{men:99,women:99,level:31936,inflation:28684},97:{men:99,women:100,level:35224,inflation:31834},98:{men:100,women:100,level:39759,inflation:36158},99:{men:101,women:101,level:47099,inflation:43087},100:{men:102,women:102,level:62283,inflation:57152}},annuity_bought_with_fv:1e5,min_age_pension:55,max_age_pension:100,state_pension_week:168.6,max_TFC:25,inflation:2.5,pension_charge:.75,investment_return_arr:e,netpa:t,pensionage:{"1954-10-05":65,"1961-03-05":66,"1961-03-06":67},taxLumpSum:{1:{grossBand:12500,rate:0},2:{grossBand:37500,rate:20},3:{grossBand:5e4,rate:40},4:{grossBand:25e3,rate:60},5:{grossBand:25e3,rate:40},last:{grossBand:15e4,rate:45}},mail_templates:{printoption:"test-rop-1","contact us":"lemonade-contact-us"},contact_email:"_",contact_phone:"_",branding:{mainColor:"#5dc3bb",mainColorDark:"#3c474c",mainColorLight:"#ed1559",inverseColor:"#8f9493",bgColor:"#efedea",companyName:"_Lemonade",headerFontColor:"#ffffff",fontColor:"#e9004c",logo:"http://storage.lemonadellp.com/upload/images/54009543.png",headerlogo:"http://storage.lemonadellp.com/upload/images/50178089.png"}}}}),function(e,l){function t(e,t,a,n,r){var o=this;this.data;var i="siemens";0<=n.absUrl().indexOf("localhost")||0<=n.absUrl().indexOf("127.0.0.1")?o.api="http://localhost/api/rop/"+i:o.api="http://php.lemonadellp.com/rop/"+i,this.getApiData=function(){return l.isDefined(e.basedata)?e.basedata:a({timeout:3e3,method:"POST",url:o.api,headers:{"Content-Type":"application/json; charset=utf-8"}})},this.getBackupData=function(){return r.getBackupData()}}t.$inject=["$rootScope","$q","$http","$location","BaseBackupService"],l.module("lemonadeReward").service("BaseDataService",t)}(window.$,window.angular),function(e,c){function t(i,o){var l=this;function e(){var a=o.path().split("/")[1]+"/"+o.path().split("/")[2],n=!0,r=1;return c.forEach(l.stepOrder,function(e,t){n&&e==a.toString()&&(r=t,n=!1)}),r}function t(){return l.urlToNumber()<1?l.urlToNumber():parseInt(l.urlToNumber())-1}function a(){return 0<l.urlToNumber()?parseInt(l.urlToNumber())+1:l.urlToNumber()}function n(){var a=o.path().split("/")[1],n=!0,r=l.mainStepNum.about;return c.forEach(l.mainStepNum,function(e,t){n&&t==a&&(r=e,n=!1)}),r}l.footerShow=function(){var e=!0;"/print"==o.path()&&(e=!1);return e},l.speakExpBtn=function(){var e="print";"/options/annuity"==o.path()?e="annuity":"/options/flexible"==o.path()?e="flexible":"/options/cashout"==o.path()&&(e="cashout");return{modalView:e}},l.companyName=function(){var e=i.appData.branding.companyName;if("_"==e.charAt(0))var t=e.substring(1),a=!0;else t=e,a=!1;return{display:t,hide:a}},l.getHeader=function(){var e;switch(o.path()){case"/print":case"/":e=!1;break;default:e=!0}return{showHeader:e}},l.getStep=function(){return{nextUrl:l.nextStepURL(),prevUrl:l.backStepURL(),currentNumber:e(),mainStep:n()}},l.urlToNumber=e,l.backStepNumber=t,l.backStepURL=function(){return l.stepOrder[t()]},l.nextStepNumber=a,l.nextStepURL=function(){return l.stepOrder[a()]},l.mainStepArr=n,l.mainStepNum={about:[1,2,3],pension:[4,5,6],plans:[7,8,9],"options:":[10]},l.stepOrder={0:"/",1:"about/age",2:"about/retirement",3:"about/gender",4:"pension/pot",5:"pension/final",6:"pension/state",7:"plans/salary",8:"plans/yoursavings",9:"plans/employersavings",10:"options/table"},l.validAbout=function(e,t){i.validAbout[e]=t},l.validPension=function(e,t){i.validPension[e]=t},l.validPlans=function(e,t){i.validPlans[e]=t},l.ageValid=function(){var e=!0,t="";return t=null!=i.DOB?(e=!0,""):(e=!1,"Before we can go further please select your date of birth."),{valid:e,error:t}},l.retageValid=function(){var e=!0,t="";return t=i.about_ret>=i.sliderMinAge&&i.timeline.upto>i.about_ret?(e=!0,""):(e=!1,"Your retirement age has to be between: "+i.sliderMinAge+" and "+i.timeline.upto),{valid:e,error:t}},l.genderValid=function(){var e=!0,t="";return t="male"==i.about_gender||"female"==i.about_gender?(e=!0,""):(e=!1,"Please select your gender."),{valid:e,error:t}},l.potValid=function(){var a=!0,n="";if(i.pension_potList.length<=0)a=!0,n="";else{c.forEach(i.pension_potList,function(e,t){"name"in e&&0<e.name.length&&("value"in e?null==e.value&&(a=!1,n="Latest Value of "+e.name+" is not a valid number."):(a=!1,n="Latest Value of"+e.name+"is not a valid number."))})}return{valid:a,error:n}},l.finalValid=function(){var n=!0,r="";if(i.pension_potSum<=0&&i.finalsalary_sum<=0)n=!1,r="Your total Pension Pot and Final Salary cannot be 0 at the same time.";else if(i.finalsalary_list.length<=0)n=!0,r="";else{var o=!0;c.forEach(i.finalsalary_list,function(e,t){var a=Object.keys(e);o&&(1==a.length||("name"in e?""==e.name||null==e.name?(n=!1,o=!(r="One of your pension pot names is not a valid or empty.")):(null!=e.value||null!=e.from||""!=e.name&&"name"in e)&&(""==e.value||null==e.value?(n=!1,r="Please provide a valid Latest Value for "+e.name,o=!1):""!=e.from&&null!=e.from||(n=!1,r="Please provide a valid Payable From value for "+e.name,o=!1)):(n=!1,o=!(r="Please provide a valid Company Name for your Final Salary."))))})}return{valid:n,error:r}},l.stateValid=function(){var e=!0,t="";return""==i.state&&(e=!1,t="Please select one of the options."),0==parseInt(i.statePensionAssValue)?(e=!1,t="State Pension has to be bigger than £0"):"yes"==i.state&&""==i.statePensionAssValue&&(e=!1,t="State Pension is not a valid number"),{valid:e,error:t}},l.salaryValid=function(){var e=!0,t="";return""==i.salaryBeforeTax?(e=!0,t="",i.salaryBeforeTax=0):t=0<=i.salaryBeforeTax?(e=!0,""):(e=!1,"Please provide a valid number."),{valid:e,error:t}},l.yourSaveValid=function(){var e=!0,t="";return null==i.yourSavings||null==i.yourSavings||NaN===i.yourSavings?(e=!1,t="Please provide at least one value"):"yes"==i.amount?0<=i.yourSavingValue||(e=!1,t="The monthly amount is not valid"):"no"==i.amount&&(0<(i.yourSavingPer<100)||(e=!1,t="The monthly percentage is not valid")),{valid:e,error:t}},l.empSaveValid=function(){var e=!0,t="";return null==i.empSavings||null==i.empSavings||NaN===i.empSavings?(e=!1,t="Please provide at least one value"):"yes"==i.empAmount?0<=i.empSavingValue||(e=!1,t="The monthly amount is not valid"):"no"==i.empAmount&&(0<(i.empSavingPer<100)||(e=!1,t="The monthly percentage is not valid")),{valid:e,error:t}},l.validate=function(){var e=!0,t="";switch(o.path()){case"/about/age":e=(a=l.ageValid()).valid,t=a.error,l.validAbout(0,e);break;case"/about/retirement":e=(a=l.retageValid()).valid,t=a.error,l.validAbout(1,e);break;case"/about/gender":e=(a=l.genderValid()).valid,t=a.error,l.validAbout(2,e);break;case"/pension/pot":e=(a=l.potValid()).valid,t=a.error,l.validPension(0,e);break;case"/pension/final":e=(a=l.finalValid()).valid,t=a.error,l.validPension(1,e);break;case"/pension/state":e=(a=l.stateValid()).valid,t=a.error,l.validPension(2,e);break;case"/plans/salary":e=(a=l.salaryValid()).valid,t=a.error,l.validPlans(0,e);break;case"/plans/yoursavings":e=(a=l.yourSaveValid()).valid,t=a.error,l.validPlans(1,e);break;case"/plans/employersavings":var a;e=(a=l.empSaveValid()).valid,t=a.error,l.validPlans(2,e)}return{valid:e,error:t}},l.lastInputStep=!1,i.$on("$locationChangeSuccess",function(){l.url="/"+l.stepOrder[9],l.url==o.path()?i.lastInputStep=!0:i.lastInputStep=!1})}t.$inject=["$rootScope","$location"],c.module("lemonadeReward").service("BreadcrumbService",t)}(window.$,window.angular),function(e,_){function t(P,x){var $=this;function e(e,t){var a=parseFloat(P.yourSavings)+parseFloat(P.empSavings),n=a*(Math.pow(1+t.numberPm,e.months)-1)/t.numberPm;return{yourSavings:P.yourSavings,empSavings:P.empSavings,currentPremiumsMonthly:a,futurePremium:n,growthrateMontly:t.numberPm,monthsToRet:t.numberPm}}$.mainCollector=function(){var e=$.annuityLongevity(),t=$.inflation(),a=$.netgrowth(t),n=$.dob(),r=$.dateAtRetirement(n.obj,n,e),o=$.timeToRetirement(r.obj),i=$.statePensionAge(n.obj),l=(a=$.netgrowth(t),$.futurePremium(o,a)),c=$.futurePensionPot(o,a),s=$.pensionFundAtRetirement(l,c),u=$.finalsalaryChart(i),d=$.statepensionChart(i),m=$.annuity(s,e,t,i,u,d),p=$.taxLumpSum(s),f=$.cashOut(p,u,d),h=$.pmt(a,r,s,0,1),g=$.flexible(h,i,t,s,a,e,u,d),w=$.flexibleFixIncome(h,i,t,s,a,e,u,d,r,g),v=$.flexibleChart(g,w,u,d),y=$.chartHelper(g,m,i);P.calculationCounter=P.calculationCounter+1;var b={inflation:t,netGrowth:a,DOB:n,dateAtRet:r,timeToRet:o,statePension:i,futurePremium:l,futurePensionPot:c,pensionFundAtRetirement:s,annuityLongevity:e,annuity:m,cashOut:f,flexible:g,flexibleFixIncome:w,flexibleChart:v,chartHelper:y,taxLumpSum:p};return P.clonelink=x.cloneLink(),b},$.dob=function(){var e=new Date(P.DOB),t=e.getFullYear(),a=e.getMonth(),n=e.getDate(),r=new Date(t,a,n),o=Date.now()-e.getTime(),i=new Date(o),l=Math.abs(i.getUTCFullYear()-1970);return P.about_age=l,{string:n+"/"+["January","February","March","April","May","June","July","August","September","October","November","December"][a]+"/"+t,obj:r,age:l}},$.dateAtRetirement=function(e,t,a){var n=e.getFullYear(),r=e.getMonth(),o=e.getDate(),i=new Date(n+P.about_ret,r,o),l=n+P.about_ret,c=0;P.about_ret>t.age&&(c=P.about_ret-t.age);return{string:o+"/"+["January","February","March","April","May","June","July","August","September","October","November","December"][r]+"/"+l,SelectedRetAge:P.about_ret,YearsToRet:c,YearsInRet:a.lifeExpectancy-P.about_ret,obj:i}},$.timeToRetirement=function(e){var t=(new Date).getTime(),a=e.getTime();if(a<=t)var n=0;else n=a-t;var r=n/1e3/60/60,o=Math.floor(r/24),i=Math.floor(o/7),l=o/365.25,c=Math.floor(12*l);return{days:o,weeks:i,months:c,years:l}},$.statePensionAge=function(a){var n=[],r=[],o=new Date("1900-01-01"),i=new Date("2100-01-01"),l="",c="";new Date("1900-01-01");_.forEach(P.appData.pensionage,function(e,t){var a=new Date(t);a.getTime()>o.getTime()&&(o=a,c=e),a.getTime()<i.getTime()&&(i=a,l=e),r[e]={age:e,date:new Date(t)},n.push({age:e,date:new Date(t)})});var s=0;new Date("1900-01-01");if(_.forEach(r,function(e,t){1}),a.getTime()>=o.getTime())s=c;else{var u=0;r.slice().reverse().forEach(function(e,t){0!=u&&a.getTime()<=e.date.getTime()&&(s=e.age),u+=1})}if(null==P.statePensionAssValue||NaN==P.statePensionAssValue||""==P.statePensionAssValue)var e=0;else e=parseInt(P.statePensionAssValue);return{statePensionAge:s,stateRealArray:r,max:o,maxAge:c,min:i,minAge:l,statePensionWeek:e/52,statePensionMonth:e/12,statePensionYear:e}},$.futurePremium=e,$.inflation=function(){var e=P.inflation/100;return{percentage:P.inflation,number:e}},$.netgrowth=function(a){var n="none",r=0,o=0,i=0,l=0,c={};return _.forEach(P.appData.investment_return_arr,function(e,t){c[t]=e-P.pension_charge-a.percentage}),_.forEach(c,function(e,t){P.growthRateText.toLowerCase()==t.toLowerCase()&&(n=t,r=e/100,o=e,l=Math.abs(Math.pow(1+r,1/12)-1),i=100*l)}),{stringPa:n,numberPa:r,percentagePa:o,numberPm:l,percentagePm:i,netPa:c}},$.futurePremium=e,$.futurePensionPot=function(e,t){return{futurePensionPot:P.pension_potSum*Math.pow(1+t.numberPm,e.months),netGrowth_pm:t.numberPm,timeToRetMonths:e.months}},$.pensionFundAtRetirement=function(e,t){var a=t.futurePensionPot+e.futurePremium,n=a*(P.tfcToken/100),r=a-n;return{fullFuturePension:a,tcfPercent:P.tfcToken,tcfMaxPercent:P.appData.max_TFC,tcfValue:n,tcfValueFormatted:"£"+n.toFixed(0),remainingFutureFound:r,remainingFutureFoundFormatted:"£"+r.toFixed(0)}},$.annuityLongevity=function(){var e=P.about_gender.toLowerCase();if("male"==e)var t="men";else t="women";var a=P.appData.life_expectancy[P.about_ret][t];if("yes"==P.realterms)var n="inflation";else n="level";var r=P.appData.life_expectancy[P.about_ret][n]/P.appData.annuity_bought_with_fv;return{lifeExpectancy:a,level:r,gender:e,realterms:P.realterms,income:n,fix:P.appData.annuity_bought_with_fv,test_income:P.appData.life_expectancy[P.about_ret][n]}},$.annuity=function(e,t,a,n,r,o){for(var i,l=e.remainingFutureFound*t.level,c=new Array,s=new Array,u=0,d=0,m=parseInt(P.about_ret);m<=parseInt(P.timeline.upto);m++){var p=A(l,a.number,m-P.about_ret,P.realterms);m<=t.lifeExpectancy&&(u+=p),d<p&&(d=p),e.remainingFutureFound<p&&(p=e.remainingFutureFound),s={x:m,y:p},c.push(s)}var f=new Array;"yes"==P.state&&f.push(o);0<r.length&&0<P.finalsalary_sum&&_.forEach(r,function(e,t){f.push(e)});return i={key:"Annuity",values:c,color:"#ef7e0a"},console.log(i),f.push(i),{eachYearBeforeTax:l,sumAnnuity:u,totalpayment:u+e.tcfValue,chart:f,maxAnnuity:d}},$.cashOut=function(e,t,a){var n=new Array;"yes"==P.state&&n.push(a);0<t.length&&0<P.finalsalary_sum&&_.forEach(t,function(e,t){n.push(e)});return{taxLumpSum:e.sumTax,chart:n}},$.taxLumpSum=function(e){var r=e.remainingFutureFound,o=new Array,i=0,l=0;return _.forEach(P.appData.taxLumpSum,function(e,t){if("last"==t)var a=(r-i)*(e.rate/100);else if(r<e.grossBand+i)a=(r-i)*(e.rate/100);else a=e.grossBand*(e.rate/100);var n={grossBand:e.grossBand,threshold:e.grossBand+i,rate:e.rate,remain:r-i,tax:a};i<r&&(o.push(n),l+=a),i+=e.grossBand}),{sumTax:l}},$.pmt=function(e,t,a,n,r){var o=e.numberPa,i=t.YearsInRet,l=a.remainingFutureFound,c=n,s=r;{if(c=void 0!==c?c:0,s=void 0!==s?s:0,0!=o){var u=Math.pow(1+o,i);return-o*(c+u*l)/((-1+u)*(1+o*s))}if(0!=i)return-(c+l)/i}return 0},$.flexible=function(e,t,a,n,r,o,i,l){if(0<=P.incomeTarget){var c=P.incomeTarget-t.statePensionYear-P.finalsalary_sum,s=P.incomeTarget;c=P.incomeTarget;0<t.statePensionYear&&(c-=t.statePensionYear),0<P.finalsalary_sum&&(c-=P.finalsalary_sum);s=P.incomeTarget}else{c=-1*e;0<t.statePensionYear&&(c+=t.statePensionYear),0<P.finalsalary_sum&&(c+=P.finalsalary_sum);s=c;P.incomeTarget=s}P.requiredIncome=c;var u=0,d=0,m=(u=0,0),p="";p="yes"==P.realterms?"no":"yes";for(var f=new Array,h=r.numberPa+a.number,g=0,w=0,v=0,y=0,b=0,x=parseInt(P.about_ret);x<=parseInt(P.timeline.upto);x++){var $=T(c,a.number,x-P.about_ret,p);w=0==u?n.remainingFutureFound-$:T(u,h,1,"no")-$,g=w<0?0:A(w,a.number,x-P.about_ret,"no");var S=A(0==b?$:d<=0?0:u<$?u:$,a.number,x-P.about_ret,"no");if(m+=S,o.lifeExpectancy<x)var _=0;else _=m+g;v<_&&(v=_),y<S&&(y=S);S<0&&(S=0);var C={x:x,y:S};u=w,d=g,b+=1,f.push(C)}return{requiredIncome:c,eachYearBeforeTax:s,flexibleSeries:f,totalpayment:v+n.tcfValue,maxFlexible:y}},$.flexibleFixIncome=function(e,t,a,n,r,o,i,l,c,s){"yes"==P.realterms?"no":"yes";var u=new Array,d=(r.numberPa,a.number,s.requiredIncome,new Array),m=Array();if(0<i.length&&0<P.finalsalary_sum)_.forEach(i,function(e,a){var t=Array();m[a]={from:e.payableFrom,annualy:e.annualy,values:t},_.forEach(e.values,function(e,t){m[a].values[e.x]=e.y})});else{var p=Array();m[0]={from:P.about_ret,values:p};for(var f=parseInt(P.about_ret);f<=parseInt(P.timeline.upto);f++)m[0].values[f]=0}var h=Array();if(1==P.stateValue)_.forEach(l.values,function(e,t){h[e.x]=e.y});else for(f=parseInt(P.about_ret);f<=parseInt(P.timeline.upto);f++)h[f]=0;var g=0;for(f=parseInt(P.about_ret);f<=parseInt(P.timeline.upto);f++)"yes"==P.realterms?0==g?(d[f]=s.requiredIncome,f<t.statePensionAge&&(d[f]+=t.statePensionYear),0<i.length&&0<P.finalsalary_sum&&_.forEach(m,function(e,t){f<e.from&&(d[f]+=e.annualy)})):(d[f]=0,d[f]+=S(d[f-1],a.number,1),0<i.length&&0<P.finalsalary_sum&&_.forEach(m,function(e,t){f==e.from&&(d[f]-=S(e.values[f],a.number,e.from-c.SelectedRetAge))}),f==t.statePensionAge&&(d[f]-=S(t.statePensionYear,a.number,t.statePensionAge-c.SelectedRetAge))):0==g?(d[f]=s.requiredIncome,f<t.statePensionAge&&(d[f]+=t.statePensionYear),0<i.length&&0<P.finalsalary_sum&&_.forEach(m,function(e,t){f<e.from&&(d[f]+=e.annualy)})):(d[f]=0,d[f]+=d[f-1],0<i.length&&0<P.finalsalary_sum&&_.forEach(m,function(e,t){f==e.from&&(d[f]-=S(e.values[f],a.number,f-c.SelectedRetAge))}),f==t.statePensionAge&&(d[f]-=S(t.statePensionYear,a.number,f-c.SelectedRetAge))),g+=1;var w=Array(),v=Array(),y=Array(),b=0;_.forEach(d,function(e,t){0==b?(w[t]=n.remainingFutureFound-e,0<w[t]?v[t]=w[t]:v[t]=0,y[t]=e):(w[t]=S(w[t-1],a.number+r.numberPa,1)-e,0<w[t]?v[t]=S(w[t],a.number,c.SelectedRetAge-t):v[t]=0,v[t-1]<=0?y[t]=0:w[t-1]<e?y[t]=w[t-1]:y[t]=e,y[t]=S(y[t],a.number,c.SelectedRetAge-t)),b+=1});u=new Array;return _.forEach(y,function(e,t){e<0&&(e=0),n.remainingFutureFound<e&&(e=n.remainingFutureFound);var a={x:t,y:e};u.push(a)}),{finalsalaryChart:i,fillReal:d,ddFundActual:w,ddFundPV:v,flexiblePV:y,flexibleSeries:u,sumFinal:m,sumStatePension:h}},$.inflator=A,$.deflator=T,$.finalsalaryChart=function(e){var l=new Array,c=["#4e4e4e","#161616","#000000"];return _.forEach(P.finalsalary_list,function(e,t){for(var a=new Array,n=new Array,r=new Array,o=e.name,i=parseInt(P.about_ret);i<=parseInt(P.timeline.upto);i++)a=e.from>i?{x:i,y:0}:{x:i,y:parseFloat(e.value)},n.push(a);r={key:o,values:n,color:c[t],payableFrom:parseInt(e.from),annualy:parseFloat(e.value)},l.push(r)}),l},$.statepensionChart=function(e){var t=0,a=new Array,n=new Array;if(1==P.stateValue)for(var r=parseInt(P.about_ret);r<=parseInt(P.timeline.upto);r++){t=e.statePensionAge<=r?parseInt(e.statePensionYear):0,a={x:r,y:t},n.push(a)}return{key:"State Pension",values:n,color:"#8d8d8d",annualy:parseInt(e.statePensionYear)}},$.flexibleChart=function(e,t,a,n){var r=new Array;"yes"==P.state&&r.push(n);0<a.length&&0<P.finalsalary_sum&&_.forEach(a,function(e,t){r.push(e)});if("yes"==P.fixIncomeLevel)var o=t.flexibleSeries;else o=e.flexibleSeries;var i=[];_.forEach(o,function(e,t){0<e.y&&(i=e)});var l={key:"Flexible",values:o,color:"#ef7e0a"};return r.push(l),{chart:r,runOut:i}},$.chartHelper=function(e,t,a){var n=0,r=0;"yes"==P.state&&(n=a.statePensionYear,r=a.statePensionYear);0<P.finalsalary_list.length&&(n+=P.finalsalary_sum,r+=P.finalsalary_sum);e.maxFlexible<t.maxAnnuity?n+=t.maxAnnuity:n+=e.maxFlexible;return{maxYaxis:Math.ceil(n/100*100*1.7),limitMaxYaxis:Math.ceil(n/100*100*1.4),limitMinYaxis:r}};var A=function(e,t,a,n){return"yes"==n?e:e/Math.pow(1+t,a)},T=function(e,t,a,n){return"yes"==n?e:e*Math.pow(1+t,a)},S=function(e,t,a){return e*Math.pow(1+t,a)}}t.$inject=["$rootScope","ClonelinkService"],_.module("lemonadeReward").service("CalculationService",t)}(window.$,window.angular),function(e,r){function t(n,e,t){this.storeGet=function(e){n.tableCounter=10,n.DOB=new Date(e.dob),n.about_ret=parseInt(e.ret),n.retChanged=!0,"male"==e.gen?n.about_gender="male":n.about_gender="female";if(n.pension_potSum=parseInt(e.pot),n.pension_potList=new Array,n.pension_potList.push({id:"pot1",name:"",value:parseInt(e.pot)}),"_"==e.fin)n.finalsalary_list=[];else{var t=e.fin.split("|"),a=new Array;n.finalsalary_sum=0,r.forEach(t,function(e){var t=JSON.parse(e);n.finalsalary_sum+=parseInt(t.value),a.push(t)}),n.finalsalary_list=a}"yes"==e.state?n.state="yes":"no"==e.state?n.state="no":e.state;"true"==e.stateV?n.stateValue=!0:n.stateValue=!1;n.statePensionAssValue=parseInt(e.stateAV),n.salaryBeforeTax=parseInt(e.salary),n.yourSavings=parseFloat(e.yourcon),"yes"==e.youramount?(n.amount="yes",n.yourSavingPer="",n.yourSavingValue=parseFloat(e.yourcon)):(n.amount="no",n.yourPerc=parseFloat(e.yourper),n.yourSavingPer=parseFloat(e.yourper));n.empSavings=parseFloat(e.empcon),"yes"==e.empAmount?(n.empAmount="yes",n.empSavingValue=parseFloat(e.empcon)):(n.empAmount="no",n.empPerc=parseFloat(e.empper));0<=e.target?n.incomeTarget=e.target:n.incomeTarget="";99.99<parseFloat(e.inf)?n.inflation=99.99:parseFloat(e.inf)<0?n.inflation=0:n.inflation=parseFloat(e.inf);99.99<parseFloat(e.amc)?n.pension_charge=99.99:parseFloat(e.amc)<0?n.pension_charge=0:n.pension_charge=parseFloat(e.amc);parseInt(e.tfc)<0?n.tfcToken=0:parseInt(e.tfc)>n.appData.max_TFC?n.tfcToken=n.appData.max_TFC:n.tfcToken=parseInt(e.tfc);"low"==e.growth?n.growthRateText="low":"high"==e.growth?n.growthRateText="high":n.growthRateText="mid";"yes"==e.real?n.realterms="yes":n.realterms="no";"yes"==e.fix?n.fixIncomeLevel="yes":n.fixIncomeLevel="no"}}t.$inject=["$rootScope","BreadcrumbService","CalculationService"],r.module("lemonadeReward").service("CloneService",t)}(window.$,window.angular),function(e,o){function t(t,n,a){var r=this;r.cloneLink=function(){var a="";o.forEach(t.finalsalary_list,function(e,t){0!=t&&(a+="|"),a+=JSON.stringify(e)}),0==a.length&&(a="_");var e={clone:"yes",dob:t.DOB,ret:t.about_ret,gen:t.about_gender,pot:t.pension_potSum,fin:a,state:t.state,stateV:t.stateValue,stateAV:t.statePensionAssValue,salary:t.salaryBeforeTax,yourcon:t.yourSavings,yourper:t.yourPerc,youramount:t.amount,empcon:t.empSavings,empamount:t.empAmount,empper:t.empPerc,inf:t.inflation,amc:t.pension_charge,tfc:t.tfcToken,growth:t.growthRateText,real:t.realterms,fix:t.fixIncomeLevel,target:t.incomeTarget};return r.getDomain()+"/clone/?"+n(e)},r.getDomain=function(){var e=a.protocol()+"://"+a.host();0<a.port()&&(e=e+":"+a.port());return e}}t.$inject=["$rootScope","$httpParamSerializer","$location"],o.module("lemonadeReward").service("ClonelinkService",t)}(window.$,window.angular),function(r,e){function t(e,t,a){var n=this;n.mail=function(e){return t({method:"POST",url:n.api,data:r.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},0<=a.absUrl().indexOf("localhost")||0<=a.absUrl().indexOf("127.0.0.1")?n.api="http://localhost/api/notification/atretirement":n.api="https://php.lemonadellp.com/notification/atretirement"}t.$inject=["$rootScope","$http","$location"],e.module("lemonadeReward").service("ContactService",t)}(window.$,window.angular),window.$,window.angular.module("lemonadeReward").service("DetectionService",function(){var t=this;t.get=function(){var e=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(0<t)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(0<e.indexOf("Trident/")){var a=e.indexOf("rv:");return parseInt(e.substring(a+3,e.indexOf(".",a)),10)}var n=e.indexOf("Edge/");return 0<n&&parseInt(e.substring(n+5,e.indexOf(".",n)),10)}();return t.browser=!1===e?"other":12<=e?"edge":"ie1011",t.browser}}),function(e,t){function a(e){var l=this;l.generate=function(){l.date=new Date;var e=l.date.getMonth()+1,t=l.date.getDate(),a=l.date.getHours(),n=l.date.getMinutes(),r=Math.floor(10*Math.random()+1),o=Math.floor(10*Math.random()+1),i=Math.floor(10*Math.random()+1);return r.toString()+o.toString()+e.toString()+t.toString()+i.toString()+a.toString()+n.toString()}}a.$inject=["$rootScope"],t.module("lemonadeReward").service("GenerateID",a)}(window.$,window.angular),function(r,e){function t(e,t,a){var n=this;n.mail=function(e){return t({method:"POST",url:n.api,data:r.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded,charset=UTF-8",Accept:"application/json"}})},0<=a.absUrl().indexOf("localhost")||0<=a.absUrl().indexOf("127.0.0.1")?n.api="http://localhost/api/printrop/printout":n.api="https://php.lemonadellp.com/printrop/printout"}t.$inject=["$rootScope","$http","$location"],e.module("lemonadeReward").service("PrintService",t)}(window.$,window.angular);